# Schema Design

[best practices](https://cloud.google.com/spanner/docs/schema-design)

## 考虑扩展的设计

- **主键（PK）**：不能是时间戳，或者自增主键，可以使用uuid，或者对唯一id进行hash计算
  - 由于分布式特性，spanner会按照字母和数字顺序排序，将数据分片（split）分布到不同节点，如果使用单一递增则可能会导致数据分片不均匀，从而导致性能下降。
-  **索引（Index）**：
   1. 分析查询模式： 找出最常用、最慢的查询语句。
   2. 按需创建： 只为那些能从索引中获得巨大性能提升的查询创建索引。
   3. 避免冗余： 不要创建重复或多余的索引。一个设计良好的复合索引（Multi-columnIndex）可能比多个单列索引更有效。
   4. 定期审查： 监控索引的使用情况，删除那些很少被查询用到的“僵尸索引”。索引能够提高查询效率，但过多的索引会导致写入性能下降，占用磁盘空间增多
-  **表交错(Table Interleaving)**: 它是一种物理存储策略，能将子表的数据行，物理上“塞到”其关联的父表数据行的旁边，从而减少进程通信提高性能
 
